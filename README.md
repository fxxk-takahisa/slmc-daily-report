# SLMC日次報告書作成システム v2.1.6

## 📋 プロジェクト概要

**マルチブロック対応の日次報告書作成Webアプリケーション**です。4つのブロック（東、センター、西、DCL）それぞれの異なるフォーマットに対応し、毎日の業務データを簡単に入力・管理・レポート生成できます。

---

## 🎯 現在完成している機能

### ✅ v2.1.7 最新機能（2025-11-22）🎉

#### 1. **Webメール完全対応** ✉️
- ✨ Gmail/Outlook.comのWeb版から直接送信可能
- **Gmailで開く**ボタン：GmailブラウザUPで新規メール作成
- **Outlook.comで開く**ボタン：Outlook.comで新規メール作成
- **メールソフトで開く**ボタン：従来のmailto:方式
- **クリップボードにコピー**ボタン：手動貼り付け用
- メールソフト不要で、どの環境でも送信可能に

#### 2. **システム内マニュアル閲覧** 📖
- ✨ ダッシュボードの「マニュアル」ボタンからシステム内で閲覧
- モーダルウィンドウで表示、別ファイル不要
- v2.1.7の全機能を網羅した完全版マニュアル

#### 3. **複数レポート一括ZIP出力** 📦
- ✨ 日次・週次・月次・累計・CSVを選択してZIPダウンロード
- チェックボックスで出力項目を選択
- 1つのZIPファイルにまとめて効率的に管理
- 複数人への配布が簡単に

#### 4. **ドラッグ&ドロップインポート** 🎯
- ✨ ファイルをドラッグするだけでインポート
- **ZIP対応**：ZIPファイルを直接インポート
- **CSV対応**：CSVファイルからもインポート可能
- **JSON対応**：従来通りJSONもサポート
- ドラッグ&ドロップエリアで視覚的に操作

### ✅ v2.1.3 機能（2025-11-12）

#### 1. **データ編集機能**
- ✨ 保存済みデータの数値を編集可能
- データ管理画面の「編集」ボタンからアクセス
- 日付・BASE名・報告者名は読み取り専用（編集不可）
- 全ての数値フィールドを一括編集
- 入力ミスの修正が簡単に

#### 2. **データインポート機能**
- ✨ バックアップしたJSONファイルをインポート
- **追加モード**：既存データを保持して追加（重複チェック付き）
- **置き換えモード**：全データを置き換え（確認メッセージ付き）
- インポート前にプレビュー表示
- 重複データの自動検出
- データ消失時の復旧が可能

### ✅ v2.1.2 機能（2025-11-11）

#### 1. **複数メールアドレス選択機能**
- ✨ チェックボックス式で複数の送信先を同時選択可能に
- 一度に複数の関係者へ報告を送信できる
- 選択数が画面に表示され、確認しやすい
- mailto: リンクでカンマ区切りの複数宛先に対応

#### 2. **月累計・平均の自動計算機能**
- ✨ 月累計・平均の手入力フィールドを完全廃止
- 既存データから自動計算（当月のデータを集計）
- **東・西・DCLブロック**: 4項目自動計算（FX累計、FX紹介累計、CC累計、純増累計）
- **センターブロック**: 7項目自動計算（FX累計、CC累計、純増累計、VC月平均、ClubEX+商品MEXALL累計、クリニック累計、クリニック白書面談累計）
- 平均値は小数点第1位まで表示（Math.round方式）
- 入力ミスの防止と作業時間の大幅短縮

#### 3. **BASEプレースホルダーの変更**
- BASE名入力欄のプレースホルダーを「太田」に変更
- より実際の使用例に即した入力ガイド

### ✅ v2.1.1 機能

#### 1. **メール設定の改善**
- タブ名を「メール設定」に変更（より分かりやすく）
- 対象ブロック選択を廃止（シンプルな操作に）
- 全ブロックから全送信先を選択可能に

#### 2. **メール件名の改善**
- データ入力画面の日付とBASE名を使用
- より具体的で分かりやすい件名
- 形式: `日次報告 11月8日 SLMC西新井BASE`

#### 3. **送信先管理の簡素化**
- 送信先名の例を「PCD日次報告/DCL日次報告」に変更
- ブロック情報を削除してシンプルに
- 一覧表示も見やすく改善

### ✅ v2.1.0 機能

#### 1. **包括的なフォームバリデーション**
- 未入力項目を赤枠でハイライト表示
- エラーサマリーで入力エラーを一覧表示
- 保存ボタン押下時に自動チェック
- 最初のエラー項目へ自動スクロール

#### 2. **マイナス数値対応**
- 負の数値の入力が可能（step="any"）
- parseFloat()による正確な計算
- 累計レポートで減算も正確に反映

#### 3. **メール管理システム**
- 送信先の登録（名前、アドレス）
- 送信先一覧の表示
- 送信先の削除機能
- メールアドレス形式のバリデーション

#### 4. **メール送信機能**
- レポート生成後に送信ボタン表示
- 送信先を選択してmailto:で送信
- 件名・本文を自動生成

### ✅ v2.0 機能

#### 1. **マルチブロック対応システム**
- 4つのブロック（東、センター、西、DCL）を1つのアプリで管理
- ダッシュボードによる直感的なブロック選択UI
- ブロック間の切り替えが簡単

#### 2. **ブロック別動的フォーム生成**
- **東ブロック**: 8セクション、50項目以上
- **センターブロック**: 8セクション、40項目以上
- **西ブロック**: 9セクション、60項目以上（Life&WorkStyle追加）
- **DCL共通**: 10セクション、70項目以上（ケーズデンキ追加）

#### 3. **ブロック別日次レポート生成**
- 各ブロック固有のフォーマットで出力
- 月累計・平均の完全自動計算（v2.1.2で強化）
- そのままメールにコピー可能

#### 4. **データ管理機能**
- ブロック別データ検索・フィルタリング
- 日付範囲での検索
- データ編集・削除
- 全データエクスポート（JSON）

#### 5. **レポート機能**
- 日次レポート（当日実績）
- 週次レポート（月〜日の7日間集計）
- 月次レポート（指定月の全実績）
- 累計レポート（任意期間の集計）
- グラフ表示（FX推移、VC推移）

#### 6. **便利機能**
- 前日データコピー機能
- 今日の日付自動設定
- レスポンシブデザイン（PC/タブレット/スマホ対応）
- LocalStorageによるデータ永続化

---

## 🚀 主な機能エントリポイント

### アプリケーションURL
- **メインアプリ**: `index.html`
- **旧バージョン（バックアップ）**: `index_v1.html`

### 機能フロー

```
🏢 ブロック選択 → 📝 データ入力 → 💾 保存 → 📊 レポート生成 → 📧 メール送信
   ダッシュボード      バリデーション付き    LocalStorage    4種類のレポート   mailto:送信
```

---

## 📂 データ構造とストレージ

### LocalStorage使用データ

#### 1. **dailyReports** (日次データ)
```json
{
  "id": "タイムスタンプ",
  "block": "east|center|west|dcl",
  "reportDate": "YYYY-MM-DD",
  "baseName": "BASE名",
  "reporterName": "報告者名",
  "各フィールドデータ...": "数値"
}
```

#### 2. **emailAddresses** (メール送信先)
```json
{
  "id": "タイムスタンプ",
  "name": "送信先名",
  "address": "email@example.com"
}
```

---

## 🛠️ 未実装機能（今後の予定）

### 優先度: 高
- [x] ✅ CSVエクスポート機能（v2.1.4で実装完了）
- [x] ✅ データインポート機能（v2.1.3で実装完了）
- [ ] ブロック間の比較レポート（4ブロックの実績比較）
- [ ] 目標値設定と達成率表示（進捗管理機能）

### 優先度: 中
- [ ] PDFレポート出力（現在はテキストのみ）
- [ ] クラウド同期機能（複数デバイスでデータ共有）
- [ ] ダッシュボードのカスタマイズ（表示項目の選択）
- [ ] 通知機能（入力忘れアラート、リマインダー）

### 優先度: 低
- [ ] テーマカラー変更機能（ダークモード等）
- [ ] 多言語対応
- [ ] オフライン動作の強化（Service Worker）

---

## 📋 推奨される次のステップ

### 1. **すぐに使い始める**
- index.htmlを開いてブロックを選択
- サンプルデータを入力してレポート生成を試す
- メール送信先を登録して報告フローを確認

### 2. **運用準備**
- 各ブロックの報告者にマニュアル（MANUAL_v2.1.3.md）を共有
- メール送信先を事前に登録（複数選択で一斉送信可能）
- 前日データコピー機能の使い方を周知（月累計は自動計算されるため入力不要）
- 定期的に「全データエクスポート」でバックアップを取る（データ消失に備える）

### 3. **バックアップ設定**
- 定期的に「全データエクスポート」機能でバックアップ
- JSONファイルを安全な場所に保存

### 4. **機能拡張検討**
- CSVエクスポート強化の必要性を確認
- 目標値管理機能の要件をヒアリング
- ブロック間比較レポートのニーズを調査

---

## 🏢 各ブロックの対応項目数

| ブロック | セクション数 | 入力フィールド数 | 特徴 |
|---------|-------------|-----------------|------|
| 東ブロック | 8 | 46 | 商品・クリニック売上、VC内訳（CC/L&L/L）、月累計自動計算 |
| センターブロック | 8 | 33 | VC内訳7種類、ClubEX+商品MEXALL、月累計自動計算 |
| 西ブロック | 9 | 56 | 東ブロック + Life&WorkStyle項目、月累計自動計算 |
| DCL共通 | 10 | 66 | 西ブロック + ケーズデンキ販売実績、月累計自動計算 |

**v2.1.2での変更**: 月累計・平均の手入力フィールドを廃止し、自動計算に変更（東・西・DCL: -4項目、センター: -7項目）

---

## 🔧 技術スタック

### フロントエンド
- **HTML5**: セマンティックHTML構造
- **CSS3**: レスポンシブデザイン、Flexbox/Grid
- **JavaScript (ES6+)**: Class構文、モジュールパターン
- **Chart.js 4.4.0**: グラフ描画ライブラリ
- **Font Awesome 6.4.0**: アイコンライブラリ
- **Google Fonts (Noto Sans JP)**: 日本語フォント

### データ管理
- **LocalStorage API**: ブラウザ内データ永続化
- **JSON**: データ保存・エクスポート形式

### 対応ブラウザ
- Chrome（推奨）
- Edge
- Firefox
- Safari
- モバイルブラウザ

---

## 📞 サポート・ドキュメント

### ドキュメント一覧（v2.1.4）✨ 最新
- **README.md** (本ファイル): プロジェクト概要と完成機能
- **DEPLOYMENT_COMPARISON_v2.1.4.md**: システム公開方法の比較と推奨事項（GitHub Pages vs Webホスティング）
- **MANUAL_v2.1.3.md**: 詳細操作マニュアル（編集・インポート機能対応）
- **QUICK_START_v2.1.3.md**: クイックスタートガイド（最速1-2分での報告作成）
- **manual_v2.1.3.html**: 視覚的マニュアル（HTML版）
- **manual（本社）_v2.1.3.html**: 管理者向けマニュアル（本社のみ・BASE配布禁止）

### 旧バージョンドキュメント（v2.1.2）
- **MANUAL_v2.1.2.md**: v2.1.2マニュアル
- **QUICK_START_v2.1.2.md**: v2.1.2クイックガイド
- **EMAIL_GUIDE_v2.1.2.md**: v2.1.2メールガイド

### 旧バージョンドキュメント（v2.1.1）
- **MANUAL_v2.1.1.md**: v2.1.1マニュアル
- **QUICK_START_v2.1.1.md**: v2.1.1クイックガイド
- **EMAIL_GUIDE_v2.1.1.md**: v2.1.1メールガイド

### アーカイブドキュメント
- **README_v2.md**: v2.0/v2.1の詳細仕様書
- **MANUAL.md**: v1.x系マニュアル
- **QUICK_GUIDE.md**: v1.x系クイックガイド

---

## 🔄 バージョン履歴

### Version 2.1.7 (2025-11-22) 🎉 最新
- ✨ **Webメール完全対応**: Gmail/Outlook.com Web版から直接送信可能、メールソフト不要
- 📖 **システム内マニュアル閲覧**: ダッシュボードからモーダルでマニュアル表示、v2.1.7完全版
- 📦 **複数レポート一括ZIP出力**: 日次・週次・月次・累計・CSVを選択してZIPダウンロード
- 🎯 **ドラッグ&ドロップインポート**: ZIP/CSV/JSON対応、ファイルをドラッグするだけ
- 🔧 **インポート機能強化**: ZIP/CSV形式のインポート、自動形式判定

### Version 2.1.6 (2025-11-17)
- ✨ **メール送信のセミコロン対応**: 複数メールアドレスをセミコロン（;）で区切るように変更、メールクライアントでの送信エラーを解消
- 📊 **累計フィールドの適切な扱い**: 週次・月次・累計レポートでは累計フィールドを非表示（件数=累計のため）、日次レポートのみ月累計を表示

### Version 2.1.5 (2025-11-16)
- ✨ **週次・月次・累計レポートの合計値表示**: 各日の詳細ではなく期間合計を表示
- 📊 **自動集計機能**: 指定期間のデータを自動的に合計
- 🔢 **平均値計算**: 来場平均人数、加入単価平均、VC平均人数などを自動計算
- 📅 **期間明示**: レポートに対象期間（開始日〜終了日）を表示
- 📧 **メール送信対応**: 週次・月次・累計レポートのメール送信が可能

### Version 2.1.4 (2025-11-16)
- ✨ **週次・月次・累計レポートのフォーマット統一**: 日次レポートと同じ形式で各日のデータを個別表示（v2.1.5で変更）
- ✨ **CSVダウンロード機能の完全実装**: 全データをExcel対応CSV形式でエクスポート可能に
- 📊 **レポート生成の改善**: 週次・月次・累計レポートでもメール送信が可能に
- 📄 **デプロイメント比較ガイド**: GitHub Pages vs Webホスティングの詳細比較と推奨事項を提供
- 🎯 **BOM対応CSV**: Excel で日本語が正しく表示されるCSVファイル生成

### Version 2.1.3 (2025-11-12)
- ✨ **データ編集機能**: 保存済みデータの数値を編集可能に
- ✨ **データインポート機能**: バックアップファイルのインポートに対応
  - 追加モード：重複チェック付きで新規データを追加
  - 置き換えモード：全データを置き換え（確認メッセージ付き）
- 📊 **インポートプレビュー**: インポート前にデータをプレビュー表示
- ⚠️ **重複検出**: 同じ日付・同じブロックのデータを自動検出
- 🛡️ **データ復旧**: データ消失時の復旧が可能

### Version 2.1.2 (2025-11-11)
- ✨ **複数メールアドレス選択**: チェックボックス式で複数の送信先を同時選択可能に
- ✨ **月累計・平均の完全自動計算**: 手入力フィールドを廃止し、既存データから自動集計
  - 東・西・DCLブロック: 4項目自動計算（FX累計、FX紹介累計、CC累計、純増累計）
  - センターブロック: 7項目自動計算（FX累計、CC累計、純増累計、VC月平均、ClubEX累計、クリニック累計、白書面談累計）
- 🎯 **入力フィールド削減**: 東・西・DCL -4項目、センター -7項目（作業効率向上）
- 📝 **BASEプレースホルダー変更**: 「太田」に変更（実際の使用例に即した）
- 📊 **小数点表示**: 平均値を小数点第1位まで表示（Math.round方式）

### Version 2.1.1 (2025-11-08)
- 🎨 **タブ名変更**: 「設定」→「メール設定」
- 📧 **件名改善**: データ入力のBASE名を使用（例: 日次報告 11月8日 SLMC西新井BASE）
- 📝 **送信先名例変更**: 「PCD日次報告/DCL日次報告」
- ✨ **ブロック管理削除**: 全ブロックから全送信先を選択可能に
- 🎯 **UI簡素化**: 対象ブロック選択欄を削除

### Version 2.1.0 (2025-11-08)
- ✅ **包括的バリデーション**: 未入力項目の検出とハイライト表示
- ✅ **エラーサマリー**: 入力エラーの一覧表示と自動スクロール
- ✅ **マイナス数値対応**: 負の数値入力と正確な減算計算
- ✅ **メール管理システム**: 送信先の登録・削除・一覧表示
- ✅ **メール送信機能**: レポート内容をmailto:で送信
- 🎨 **UIクリーンアップ**: 絵文字削除

### Version 2.0.0 (2025-11-08)
- ✨ **マルチブロック対応**: 4ブロックを1つのアプリで管理
- ✨ **ダッシュボードUI**: ブロック選択画面を追加
- ✨ **ブロック別フォーム**: 各ブロックに最適化
- ✨ **ブロック別レポート**: 各フォーマットに対応
- 🔧 データ管理機能を強化（ブロック別検索）

### Version 1.1.0 (2025-11-07)
- ✨ 日次レポート機能を追加
- ✅ 月累計の自動計算機能
- ✅ 複数店舗対応のデプロイ方法を追加

### Version 1.0.0 (2025-11-07)
- ✨ 初回リリース
- ✅ 基本的なデータ入力機能
- ✅ 週次・月次・累計レポート機能

---

## 🎉 まとめ

### v2.1.4で完成した機能
✅ **マルチブロック対応** - 4ブロックを1アプリで管理  
✅ **複数メール送信** - チェックボックスで複数宛先を同時選択  
✅ **月累計完全自動計算** - 手入力不要、既存データから自動集計  
✅ **包括的バリデーション** - 入力ミスを防ぐ  
✅ **マイナス数値対応** - 正確な計算  
✅ **シンプルなメール管理** - 送信先登録と送信が簡単  
✅ **分かりやすい件名** - BASE名で識別  
✅ **4種類のレポート** - 日次・週次・月次・累計  
✅ **データ管理機能** - 検索・編集・削除・エクスポート  
✅ **レスポンシブUI** - PC/タブレット/スマホ対応  
✅ **前日データコピー** - 5-10分の作業が30秒-1分に短縮  
✅ **データ編集** - 保存済みデータの数値を後から修正可能  
✅ **データインポート** - バックアップからの復旧が可能  
✅ **CSVエクスポート** - Excel対応CSV形式でデータを出力  
✅ **レポートフォーマット統一** - 週次・月次・累計も日次形式で出力  

### 動作確認済み
- ✅ エラーなくページ読み込み完了
- ✅ すべての機能が実装済み
- ✅ コンソールエラーなし

---

## 📝 ライセンス

このプロジェクトは社内利用向けに開発されています。

---

**🎊 Version 2.1.7 完成！Webメール対応、一括ZIP出力、ドラッグ&ドロップインポートで大幅に機能強化されました。GitHub Pagesでの公開を強く推奨します。**
